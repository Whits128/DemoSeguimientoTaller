<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista Diagnóstico y Presupuesto</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- DevExtreme CSS -->
    <link rel="stylesheet" href="https://cdn3.devexpress.com/jslib/22.1.5/css/dx.light.css" />
    <!-- DevExtreme JS -->
    <script src="https://cdn3.devexpress.com/jslib/22.1.5/js/dx.all.js"></script>
    <!-- Custom CSS -->
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f7fc;
            padding-top: 50px;
        }
        .container {
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin-top: 20px;
        }
        .todo-header h2 {
            font-size: 1.8rem;
            color: #3f6f8e;
            font-weight: 600;
            text-align: center;
            margin-bottom: 30px;
        }
        .form-select {
            border-radius: 5px;
            padding: 10px;
            font-size: 1rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .task-list-container {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 10px;
        }
        .task-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #f9f9f9;
            border-radius: 10px;
            margin-bottom: 15px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s ease;
        }
        .task-item:hover {
            transform: translateY(-5px);
        }
        .task-item div {
            flex: 1;
            font-size: 1rem;
        }
        .task-item button {
            border-radius: 5px;
            padding: 8px 15px;
            font-size: 0.875rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .badge {
            font-size: 0.85rem;
            font-weight: 600;
        }
        .btn-info {
            background-color: #17a2b8;
            border-color: #17a2b8;
        }
        .btn-info:hover {
            background-color: #138496;
            border-color: #117a8b;
        }
        .btn-success {
            background-color: #28a745;
            border-color: #28a745;
        }
        .btn-success:hover {
            background-color: #218838;
            border-color: #1e7e34;
        }
        .badge-success {
            background-color: #28a745;
        }
        .badge-warning {
            background-color: #ffc107;
        }
        .badge-secondary {
            background-color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="todo-header">
            <h2>Lista de Diagnóstico y Presupuesto</h2>
        </div>

        <!-- Filtros -->
        <div class="row mb-4">
            <div class="col-md-4">
                <label for="estadoFilter">Filtrar por Estado</label>
                <select id="estadoFilter" class="form-select">
                    <option value="">Todos</option>
                    <option value="Pendiente">Pendiente</option>
                    <option value="En revisión">En revisión</option>
                    <option value="Aprobado">Aprobado</option>
                </select>
            </div>
        </div>

        <!-- Lista de Tareas -->
        <div class="task-list-container" id="taskList"></div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS (jQuery & LocalStorage Integration) -->
    <script>
        // Datos de ejemplo (más diagnósticos para comprobar el scroll)
        const sampleData = [
            { id: 1, cliente: 'Juan Pérez', telefono: '123456789', problema: 'Falla en el sistema', estado: 'Pendiente', presupuesto: 200 },
            { id: 2, cliente: 'Ana Gómez', telefono: '987654321', problema: 'Revisión de equipo', estado: 'En revisión', presupuesto: 350 },
            { id: 3, cliente: 'Carlos Rodríguez', telefono: '112233445', problema: 'Problema de software', estado: 'Aprobado', presupuesto: 450 },
            { id: 4, cliente: 'María Fernández', telefono: '556677889', problema: 'Mantenimiento preventivo', estado: 'Pendiente', presupuesto: 150 },
            { id: 5, cliente: 'Luis Morales', telefono: '998877665', problema: 'Problema de conexión', estado: 'En revisión', presupuesto: 500 },
            { id: 6, cliente: 'Pedro Fernández', telefono: '333222111', problema: 'Instalación de software', estado: 'Pendiente', presupuesto: 600 },
            { id: 7, cliente: 'Lucía García', telefono: '111222333', problema: 'Reemplazo de piezas', estado: 'Aprobado', presupuesto: 700 },
            { id: 8, cliente: 'Andrés Martínez', telefono: '444555666', problema: 'Falla en la red', estado: 'Pendiente', presupuesto: 100 },
            { id: 9, cliente: 'Sofia Pérez', telefono: '777888999', problema: 'Revisión general', estado: 'En revisión', presupuesto: 200 },
            { id: 10, cliente: 'Carlos Sánchez', telefono: '666777888', problema: 'Ajustes en el equipo', estado: 'Aprobado', presupuesto: 300 }
        ];

        // Almacenar datos en una variable
        let diagnosticos = [...sampleData]; // Copiar los datos de ejemplo a la variable

        // Función para cargar la lista de tareas
        function loadData() {
            renderTaskList(diagnosticos);
        }

        // Función para renderizar la lista de tareas
        function renderTaskList(data) {
            const taskListContainer = $('#taskList');
            taskListContainer.empty(); // Limpiar contenido

            data.forEach(task => {
                const taskItem = `
                    <div class="task-item">
                        <div>
                            <strong>${task.cliente}</strong><br>
                            Teléfono: ${task.telefono}<br>
                            Problema: ${task.problema}<br>
                            Estado: <span class="badge bg-${task.estado === 'Aprobado' ? 'success' : task.estado === 'En revisión' ? 'warning' : 'secondary'}">${task.estado}</span>
                        </div>
                        <div>
                            <button class="btn btn-info btn-sm" onclick="viewDetails(${task.id})">Ver Detalles</button>
                            ${task.estado !== 'Aprobado' ? `<button class="btn btn-success btn-sm" onclick="approveBudget(${task.id})">Aprobar</button>` : ''}
                        </div>
                    </div>
                `;
                taskListContainer.append(taskItem);
            });
        }

        // Ver detalles de la tarea
        function viewDetails(taskId) {
            const task = diagnosticos.find(t => t.id === taskId);
            if (task) {
                alert(`Detalles del diagnóstico: \nCliente: ${task.cliente}\nProblema: ${task.problema}\nPresupuesto: $${task.presupuesto}`);
            }
        }

        // Aprobar presupuesto
        function approveBudget(taskId) {
            const task = diagnosticos.find(t => t.id === taskId);
            if (task && task.estado !== 'Aprobado') {
                task.estado = 'Aprobado';
                loadData();  // Recargar los datos después de aprobar
                alert('Presupuesto aprobado correctamente.');
            }
        }

        // Filtrar por estado
        $('#estadoFilter').on('change', function() {
            const selectedState = $(this).val();
            const filteredData = diagnosticos.filter(d => !selectedState || d.estado === selectedState);
            renderTaskList(filteredData);
        });

        // Cargar datos iniciales
        loadData();
    </script>
</body>
</html>
